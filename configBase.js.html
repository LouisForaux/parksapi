<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: configBase.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: configBase.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Base Config Object
 * Supports classes with a single argument "options"
 * These will be sorted into a member called "this.config" containing all the same keys
 *
 * Crucially, these can also be overriden through environment variables
 * For example, for a config option "timeout" for class Database, this could be overriden through either:
 *   env.THEMEPARKS_TIMEOUT (using a "global module name")
 *   env.DATABASE_TIMEOUT (using the class name)
 *
 * Classes can also add additional prefixes to the supported environment variables through:
 *   new ClassInstance({configPrefixes: ['myCustomPrefix']});
 * Which would also allow env.MYCUSTOMPREFIX_TIMEOUT to be used
 *
 * Note that a default value must be supplied for the environment variable to be processed
 * If the default value is a number, the environment variable will be cast to a number as well
 */
export default class ConfigBase {
  /**
   * A base class that can be configured through environment variables
   * @param {object} options Config for instantiating this object
   */
  constructor(options = {}) {
    const config = options || {};
    const configKeys = Object.keys(config);

    this.config = {};

    const className = this.constructor.name;

    const configPrefixes = [className, 'THEMEPARKS'].concat(
        options.configPrefixes || [],
    );

    // build this.config object with our settings
    configKeys.forEach((key) => {
      // default prefixes are either "classname_" or "THEMEPARKS_"
      //  classes can add more with configPrefixes
      configPrefixes.forEach((prefix) => {
        const configEnvName = `${prefix}_${key}`.toUpperCase();

        if (process.env[configEnvName]) {
          console.log(`Using env variable config for class ${className}`);
          this.config[key] = process.env[configEnvName];
          console.log(` ${key}(env.${configEnvName})=${this.config[key]}`);
        }
      });

      if (this.config[key] === undefined) {
        this.config[key] = config[key];
      } else {
        // convert env variable to number if the base default is a number
        if (typeof config[key] === 'number') {
          this.config[key] = Number(this.config[key]);
        }
      }
    });
  }
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="module.exports.html">exports</a></li></ul><h3>Global</h3><ul><li><a href="global.html#delay">delay</a></li><li><a href="global.html#dump">dump</a></li><li><a href="global.html#get">get</a></li><li><a href="global.html#GetAllParkClasses">GetAllParkClasses</a></li><li><a href="global.html#getDumpFilename">getDumpFilename</a></li><li><a href="global.html#getWaitTimes">getWaitTimes</a></li><li><a href="global.html#init">init</a></li><li><a href="global.html#load">load</a></li><li><a href="global.html#runQuery">runQuery</a></li><li><a href="global.html#set">set</a></li><li><a href="global.html#setup">setup</a></li><li><a href="global.html#update">update</a></li><li><a href="global.html#waitForParkInitialised">waitForParkInitialised</a></li><li><a href="global.html#wrap">wrap</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.4</a> on Wed Jul 08 2020 12:07:49 GMT+0000 (Coordinated Universal Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
